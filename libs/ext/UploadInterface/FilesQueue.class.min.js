var FilesQueue=function(e,t,n){var i=this,s=e;this.$preview=t.children("figure.thumnail"),this.$index=t.children("ul"),this.index=new Object,this.count=0,this.active=new Array,this.template=function(e,t,n,i){var s='<li key="'+e+'">\n';return s+='	<div class="body">\n',s+='		<span class="name">'+t+"</span>\n",s+="ready"==n?'		<span class="size">0%</span>\n':"",s+='		<span class="status">'+n+"</span>\n",s+="	</div>\n","ready"==n&&(s+='	<div class="progress">\n',s+='		<p class="graph"><span></span></p>\n',s+="	</div>\n"),s+="	<nav>\n",s+=/^image/i.test(i)?'		<button type="button" rg-action="thumnail" class="icn-thumnail" title="썸네일이미지"></button>\n':"",s+='		<button type="button" rg-action="insertContent" class="icn-plus" title="본문에 삽입하기"></button>\n',s+='		<button type="button" rg-action="delete" class="icn-close" title="삭제"></button>\n',s+="	</nav>\n",s+="</li>",$(s)};var a=function(e){e.on("click",function(e){var t=i.getIndexItem($(this).attr("key"));i.selectQueue(t)}),e.find("nav > button").on("click",function(e){e.stopPropagation();var t=$(this).closest("li");switch($(this).attr("rg-action")){case"delete":confirm("파일을 삭제하시겠습니까?")&&i.removeQueue(t);break;case"thumnail":var n=s.queue.index[t.attr("key")];/^image/i.test(n.filetype)&&s.thumnail.open(n);break;case"insertContent":s.insertContent(t)}})};this.createQueue=function(e){var n=i.count,s="queue-"+n,l=e.status?e.status:"ready",r=i.template(s,e.name,l,e.type);return i.index[s]={filename:e.name,filesize:e.size,filetype:e.type,status:l,element:r,location:e.loc,type:e.type2,srl:e.srl},t.children("ul").append(r),a(r),i.count++,s},this.selectQueue=function(e){e.element.hasClass("on")?(e.element.removeClass("on"),i.clearPreview()):(s.key||i.$index.children().removeClass("on"),e.element.addClass("on"),/^image/i.test(e.filetype)&&i.$preview.length&&i.$preview.html('<img src="'+s.settings.fileDir+e.location+'" alt="" />'))},this.selectAllQueue=function(){i.$index.children("li").hasClass("on")?i.$index.children("li").removeClass("on"):i.$index.children("li").addClass("on")},this.removeQueue=function(e){var t=s.settings.removeAction,n=e.map(function(){var e=i.getIndexItem($(this).attr("key"));return e.type+":"+e.srl}).get().join(",");if(t){var a=$.ajax({url:t,type:"post",dataType:"json",data:{data:n}});a.fail(function(e){log("AJAX ERROR"),e.error&&e.error(e.statusText)}).done(function(t){"success"==t.status&&(e.each(function(){delete i.index[$(this).attr("key")]}),e.fadeOut(400,function(){$(this).remove()}),s.refreshAddQueue())})}},this.clearPreview=function(){i.$preview.html("")},this.getIndexItem=function(e){return i.index[e]},this.getItems=function(){return i.$index.children("li.on").map(function(e){return i.index[$(this).attr("key")]})},this.getThumnailItem=function(){return i.index[i.$index.children("li.thumnail").attr("key")]},this.updateThumnailClass=function(e){i.$index.children("li.thumnail").removeClass("thumnail"),e.addClass("thumnail")}};
//# sourceMappingURL=./FilesQueue.class.min.js.map