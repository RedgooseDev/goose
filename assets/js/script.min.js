"use strict";function Navigation(t){var e=this;this.data=null,this.page=null,this.$sideNavigation=$("#comp-side-navigation"),this.$topNavigation=$("#comp-top-navigation"),this.CompTop=React.createClass({displayName:"CompTop",getInitialState:function(){return{navData:null}},componentDidMount:function(){var t=this;$.get(this.props.sourceUrl,function(i){e.data=i,t.setState({navData:objectToArray(i)}),$(window).trigger("hashchange")})},render:function(){return React.createElement("nav",{className:"lay-top-navigation"},React.createElement(e.CompTopList,{data:this.state.navData,ref:"list"}))}}),this.CompTopList=React.createClass({displayName:"CompTopList",prev:null,updateSelected:function(t){this.refs[t]&&(this.prev&&(this.prev.className=""),this.refs[t].getDOMNode().className="active",this.prev=this.refs[t].getDOMNode())},render:function(){if(!this.props.data)return React.createElement("ul",null);var t=this.props.data.map(function(t){return React.createElement("li",{key:t.name,ref:t.name},React.createElement("a",{href:t.url,target:t.target},t.name))});return React.createElement("ul",null,t)}}),this.CompSide=React.createClass({displayName:"CompSide",getInitialState:function(){return{items:null}},update:function(t){this.setState({items:t})},componentDidMount:function(){},render:function(){return React.createElement("nav",{className:"lay-side-navigation"},React.createElement("h1",null,e.page),React.createElement(e.CompSideList,{data:this.state.items,ref:"list"}))}}),this.CompSideList=React.createClass({displayName:"CompSideList",$prev:null,updateSelected:function(t){this.$prev&&(this.$prev.removeClass("active"),this.$prev.parent().parent().filter("[data-ref]").removeClass("active"),this.$prev=null),this.$prev=$(this.getDOMNode()).find("[data-ref="+t+"]"),this.$prev.parent().parent().filter("[data-ref]").addClass("active"),this.$prev&&this.$prev.addClass("active")},render:function(){if(!this.props.data)return React.createElement("ul",null);var t=this.props.data.map(function(t){return React.createElement("li",{"data-ref":t.id},React.createElement("a",{href:"#"+t.url},t.name),t.child?React.createElement(e.CompSideList,{data:t.child}):null)});return React.createElement("ul",null,t)}}),$(window).on("hashchange.goose",function(){var t=location.hash?location.hash.replace(/^#/gi,"").split("/"):["Introduce"];if(e.data[t[0]]&&t[0]!==e.page){var i=e.data[t[0]],a=null;e.page=t[0],i.child&&(a=i.child);var n="./pages/"+e.page+".html";$("#contents").load(n,function(i,n,s){if("error"==n)log(n+": "+s.statusText);else{var r=$(this).find("[data-content-group]");if(r.length&&(a=[],r.children("section[id]").each(function(){var t=e.page+"/"+$(this).attr("id"),i={name:$(this).children("h1").children("span").text(),id:$(this).attr("id"),url:t};$(this).children("h1").append(' <a href="#'+t+'">#</a>');var n=[];$(this).children("section[id]").each(function(){var t=e.page+"/"+$(this).attr("id");n.push({name:$(this).children("h1").text(),id:$(this).attr("id"),url:t}),$(this).children("h1").append(' <a href="#'+t+'">#</a>')}),n.length&&(i.child=n),a.push(i)}),contents.setSectionTree(a)),e.top.refs.list.updateSelected(e.page),e.side.update(a),getLastItem(t))if(t.length>1){var o=0,c=$(this).find("img").length-1;$(this).find("img").one("load",function(){o++,c==o&&setTimeout(function(){contents.firstTime=!0,contents.gotoScroll(getLastItem(t)),contents.firstTime=!1},300)}).each(function(){this.complete&&$(this).load()})}else contents.gotoScroll(getLastItem(t))}contents.firstTime=!1})}else getLastItem(t)&&(contents.gotoScroll(getLastItem(t)),contents.firstTime=!1)});var i=null;$(window).on("scroll.sideNavigation",function(){var t=$(this).scrollTop(),a=e.$sideNavigation.offset().top;a>t?e.$sideNavigation.removeClass("fixed"):e.$sideNavigation.addClass("fixed"),i=$(contents.sectionTree).map(function(t){return $(this).offset().top-$(window).scrollTop()<10?this:void 0}),i=$(i).eq(i.length-1),i&&i.length&&e.side.refs.list.updateSelected(i.attr("id"))}),t&&(this.top=React.render(React.createElement(this.CompTop,{sourceUrl:t}),this.$topNavigation.get(0)),this.side=React.render(React.createElement(this.CompSide,{key:"side"}),this.$sideNavigation.get(0)))}function Contents(){var t=this;this.firstTime=!0,this.sectionTree=null,this.setSectionTree=function(e){var i=[];setArrayItem(e,i,"id","child"),t.sectionTree=i.map(function(t){return $("#"+t).length?$("#"+t)[0]:void 0})},this.gotoScroll=function(t){t&&$("#"+t).length&&(this.firstTime?imagesLoaded("#contents",function(){$("html, body").scrollTop($("#"+t).offset().top)}):(this.firstTime=this.firstTime?!1:this.firstTime,$("html, body").animate({scrollTop:$("#"+t).offset().top},400)))}}var objectToArray=function(t){var e=[];for(var i in t)e.push(t[i]);return e},getLastItem=function(t){return t[t.length-1]},setArrayItem=function t(e,i,a,n){for(var s=0;s<e.length;s++)e[s][a]&&i.push(e[s][a]),e[s][n]&&t(e[s][n],i,a,n)},navigation=new Navigation("./data/navigation.json"),contents=new Contents;
//# sourceMappingURL=../maps/script.min.js.map