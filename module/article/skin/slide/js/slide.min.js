jQuery(function(e){var a=document.writeForm,t=new UploadInterface(e("#fileUpload"),{form:a,$manager:e("#queuesManager"),uploadAction:userData.root+"/file/upload/",removeAction:userData.root+"/file/remove/",fileDir:userData.url,auto:!1,limit:30,thumnail:userData.thumnail,queueForm:[{label:"Subject",name:"subject",value:""}]});if(!t.ready)return!1;var r=userData.pushData;r=r?JSON.parse(r):null;var l=e(a).find("input[name=content]").val();try{l=l?JSON.parse(decodeURIComponent(l)):null}catch(o){l=null}if(r)if(l){for(var u=0;u<l.length;u++)for(var n=0;n<r.length;n++)if(l[u].location==r[n].location){l[u].srl=r[n].srl,l[u].filesize=r[n].filesize,l[u].filetype=r[n].filetype,l[u].state=r[n].state;break}t.pushQueue(l)}else t.pushQueue(r);e("#fileUploadButton").on("click",function(){t.upload()}),e(a).on("submit",function(){if(t.thumnailImageCheck())return!1;var e=t.thumnail.data,r={};userData.articleJSON&&(r=JSON.parse(decodeURIComponent(userData.articleJSON))),r.thumnail={srl:e.srl,coords:e.coords?e.coords.toString():"",url:e.url},a.thumnail_image.value=e.image?e.image:"",a.content.value=t.exportSlideJSON(),r=encodeURIComponent(JSON.stringify(r)),a.json.value=r})});